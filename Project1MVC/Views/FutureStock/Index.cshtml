@model IEnumerable<Project1MVC.Models.FutureStock>

@{
    ViewBag.Title = "Index";
}

<h2>Future Stocks</h2>

<table class="table">
    <thead>
        <th>
            @Html.DisplayNameFor(model => model.Type)
        </th>
        <th>
            @Html.DisplayNameFor(model => model.Brand)
        </th>
        <th>
            @Html.DisplayNameFor(model => model.Model)
        </th>
        <th>
            @Html.DisplayNameFor(model => model.OrderDate)
        </th>
        <th>
            @Html.DisplayNameFor(model => model.UnitPrice)
        </th>
        <th>
            @Html.DisplayNameFor(model => model.Qty)
        </th>
        <th>
            @Html.DisplayNameFor(model => model.NetPrice)
        </th>
        <th>
            @Html.DisplayNameFor(model => model.SupplierName)
        </th>
    </thead>
    @foreach (var item in Model)
    {
<tr>
    <td>
        @Html.DisplayFor(modelItem => item.Type)
    </td>
    <td>
        @Html.DisplayFor(modelItem => item.Brand)
    </td>
    <td>
        @Html.DisplayFor(modelItem => item.Model)
    </td>
    <td>
        @Html.DisplayFor(modelItem => item.OrderDate)
    </td>
    <td>
        @Html.DisplayFor(modelItem => item.UnitPrice)
    </td>
    <td>
        @Html.DisplayFor(modelItem => item.Qty)
    </td>
    <td>
        @Html.DisplayFor(modelItem => item.NetPrice)
    </td>
    <td>
        @Html.DisplayFor(modelItem => item.SupplierName)
    </td>
</tr>
    }

<tfoot><td colspan="8"><b>Grand Total: Rs @string.Format("{0:#,##0.00}", Convert.ToDecimal(ViewBag.GrandTotal))</b></td></tfoot>
</table>




<br />
<input type="button" class="btn btn-primary" onclick="generate()" value="Export To PDF" />
<script type="text/javascript">
    function generate() {
        var doc = new jsPDF('p', 'pt', 'letter');
        doc.autoTable({
            html: '.table',
            theme: 'grid',
            foot: [
                [{ styles: { fillColor: [255, 0, 0] } }],
            ],
            footStyles: { textColor: [229, 115, 115], fillColor: [240, 240, 240] }

        });
        doc.save('FutureStock.pdf');
    }
</script>